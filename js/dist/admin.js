(()=>{var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["common/app"];e.n(t)().initializers.add("justoverclock/profile-stories",(function(){console.log("[justoverclock/profile-stories] Hello, forum and admin!")}));const o=flarum.core.compat["admin/app"];var r=e.n(o);function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}const n=flarum.core.compat["admin/components/ExtensionPage"];var s=function(e){function t(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).fileInput=null,t.filepath=null,t}var o,n;n=e,(o=t).prototype=Object.create(n.prototype),o.prototype.constructor=o,a(o,n);var s=t.prototype;return s.oninit=function(t){e.prototype.oninit.call(this,t),this.fileInput=null,this.filepath=""},s.oncreate=function(t){e.prototype.oncreate.call(this,t)},s.uploadStoryBanner=function(e){var t,o=this;if(void 0===e&&(e=r().forum.attribute("apiUrl")+"/banner/upload"),this.fileInput&&null!=(t=this.fileInput.files)&&t.length){var a=this.fileInput.files[0],n=new FormData;n.append("storyBanner",a),r().request({method:"POST",url:e,body:n}).then((function(e){o.filepath=e.data.attributes.path,r().alerts.show({type:"success"},"Banner uploaded successfully!")})).catch((function(e){console.error("Upload failed:",e),r().alerts.show({type:"error"},"Failed to upload the banner. Please try again.")})).finally((function(){m.redraw(),window.location.reload()}))}else r().alerts.show({type:"error"},"Please select a file to upload.")},s.content=function(e){var t=this,o=r().forum.attribute("baseUrl"),a=r().forum.attribute("justoverclock-profile-stories.imagePreview")||"https://placehold.co/1920x400";return m("div",{className:"profileStoryContainer"},m("div",{className:"preview-storybanner"},m("img",{src:a?o+"/assets/"+a:"",alt:"Preview"})),m("label",{for:"storyBanner"},r().translator.trans("justoverclock-profile-stories.admin.uploadLabel")),m("p",{className:"helpText"},r().translator.trans("justoverclock-profile-stories.admin.uploadLabelHelp")),m("input",{id:"storyBanner",className:"FormControl",type:"file",name:"storyBanner",onchange:function(e){t.fileInput=e.target}}),m("button",{onclick:function(){t.uploadStoryBanner()},className:"Button"},"Save"))},t}(e.n(n)());r().initializers.add("justoverclock/profile-stories",(function(){r().extensionData.for("justoverclock-profile-stories").registerPage(s).registerPermission({icon:"fas fa-book-open",label:r().translator.trans("justoverclock-profile-stories.admin.permission.createStory"),permission:"createStory",allowGuest:!1},"start").registerPermission({icon:"fas fa-book-open",label:r().translator.trans("justoverclock-profile-stories.admin.permission.viewStory"),permission:"viewStory",allowGuest:!0},"view").registerPermission({icon:"fas fa-book-open",label:r().translator.trans("justoverclock-profile-stories.admin.permission.editStory"),permission:"editStory",allowGuest:!1},"moderate").registerPermission({icon:"fas fa-book-open",label:r().translator.trans("justoverclock-profile-stories.admin.permission.deleteStory"),permission:"deleteStory",allowGuest:!1},"moderate")}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map